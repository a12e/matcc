project(matcc)
cmake_minimum_required(VERSION 3.1)
find_package(FLEX)
find_package(BISON)
set(CMAKE_C_STANDARD 99) # pour les déclarationd d'itérateurs dans le for

FLEX_TARGET(lexer src/lexer.l ${CMAKE_CURRENT_BINARY_DIR}/lexer.c)
BISON_TARGET(parser src/parser.y ${CMAKE_CURRENT_BINARY_DIR}/parser.c)
include_directories(${CMAKE_CURRENT_BINARY_DIR})

ADD_FLEX_BISON_DEPENDENCY(lexer parser)

# Création de l'exécutable final
add_executable(matcc
		${FLEX_lexer_OUTPUTS}
		${BISON_parser_OUTPUTS}

		src/actions.h
		src/actions.c
		src/main.c
		src/utility.h
		src/utility.c
		src/hash_table.h
		src/hash_table.c
		src/quad.h
		src/quad.c
		src/quad_list.h
		src/quad_list.c
		src/symbol.h
		src/symbol.c
		src/symbol_table.h
		src/symbol_table.c
)

include_directories(src)

# Link des bibliothèques
target_link_libraries(matcc
	libfl.a
	${BISON_LIBRARIES})

